learning_rate : 0.0001
max_steps : 50
batch_size : 32
eval_freq : 500
data_dir : ./cifar10/cifar-10-batches-py
--------------Convnet initialized------------
(10000, 3, 32, 32)
-----------------------
test accuracy: 0.105
-----------------------
-----------------------
test accuracy: 0.165
-----------------------
-----------------------
test accuracy: 0.345
-----------------------
-----------------------
test accuracy: 0.455
-----------------------
epoch 1 avg accuracy on training data: 0.2847088931541907
-----------------------
test accuracy: 0.495
-----------------------
-----------------------
test accuracy: 0.485
-----------------------
-----------------------
test accuracy: 0.485
-----------------------
-----------------------
test accuracy: 0.58
-----------------------
epoch 2 avg accuracy on training data: 0.4931578104993598
-----------------------
test accuracy: 0.595
-----------------------
-----------------------
test accuracy: 0.57
-----------------------
-----------------------
test accuracy: 0.605
-----------------------
-----------------------
test accuracy: 0.625
-----------------------
epoch 3 avg accuracy on training data: 0.5717429577464789
-----------------------
test accuracy: 0.62
-----------------------
-----------------------
test accuracy: 0.655
-----------------------
-----------------------
test accuracy: 0.66
-----------------------
-----------------------
test accuracy: 0.62
-----------------------
epoch 4 avg accuracy on training data: 0.626100352112676
-----------------------
test accuracy: 0.655
-----------------------
-----------------------
test accuracy: 0.695
-----------------------
-----------------------
test accuracy: 0.665
-----------------------
-----------------------
test accuracy: 0.7
-----------------------
epoch 5 avg accuracy on training data: 0.668733994878361
-----------------------
test accuracy: 0.695
-----------------------
-----------------------
test accuracy: 0.695
-----------------------
-----------------------
test accuracy: 0.725
-----------------------
-----------------------
test accuracy: 0.71
-----------------------
epoch 6 avg accuracy on training data: 0.7021846991037132
-----------------------
test accuracy: 0.69
-----------------------
-----------------------
test accuracy: 0.73
-----------------------
-----------------------
test accuracy: 0.745
-----------------------
-----------------------
test accuracy: 0.71
-----------------------
epoch 7 avg accuracy on training data: 0.728913252240717
-----------------------
test accuracy: 0.725
-----------------------
-----------------------
test accuracy: 0.725
-----------------------
-----------------------
test accuracy: 0.73
-----------------------
-----------------------
test accuracy: 0.71
-----------------------
epoch 8 avg accuracy on training data: 0.7557818501920615
-----------------------
test accuracy: 0.725
-----------------------
-----------------------
test accuracy: 0.735
-----------------------
-----------------------
test accuracy: 0.755
-----------------------
-----------------------
test accuracy: 0.74
-----------------------
epoch 9 avg accuracy on training data: 0.7807098271446863
-----------------------
test accuracy: 0.75
-----------------------
-----------------------
test accuracy: 0.76
-----------------------
-----------------------
test accuracy: 0.73
-----------------------
-----------------------
test accuracy: 0.73
-----------------------
epoch 10 avg accuracy on training data: 0.7991357234314981
-----------------------
test accuracy: 0.76
-----------------------
-----------------------
test accuracy: 0.7
-----------------------
-----------------------
test accuracy: 0.725
-----------------------
-----------------------
test accuracy: 0.735
-----------------------
epoch 11 avg accuracy on training data: 0.8147807298335468
-----------------------
test accuracy: 0.745
-----------------------
-----------------------
test accuracy: 0.73
-----------------------
-----------------------
test accuracy: 0.74
-----------------------
-----------------------
test accuracy: 0.74
-----------------------
epoch 12 avg accuracy on training data: 0.8289052496798975
-----------------------
test accuracy: 0.725
-----------------------
-----------------------
test accuracy: 0.75
-----------------------
-----------------------
test accuracy: 0.74
-----------------------
-----------------------
test accuracy: 0.77
-----------------------
epoch 13 avg accuracy on training data: 0.8370478553137004
-----------------------
test accuracy: 0.74
-----------------------
-----------------------
test accuracy: 0.73
-----------------------
-----------------------
test accuracy: 0.75
-----------------------
-----------------------
test accuracy: 0.77
-----------------------
epoch 14 avg accuracy on training data: 0.8594750320102432
-----------------------
test accuracy: 0.805
-----------------------
-----------------------
test accuracy: 0.78
-----------------------
-----------------------
test accuracy: 0.785
-----------------------
-----------------------
test accuracy: 0.8
-----------------------
epoch 15 avg accuracy on training data: 0.9480833866837388
-----------------------
test accuracy: 0.82
-----------------------
-----------------------
test accuracy: 0.81
-----------------------
-----------------------
test accuracy: 0.8
-----------------------
-----------------------
test accuracy: 0.795
-----------------------
epoch 16 avg accuracy on training data: 0.954865556978233
-----------------------
test accuracy: 0.795
-----------------------
-----------------------
test accuracy: 0.805
-----------------------
-----------------------
test accuracy: 0.82
-----------------------
-----------------------
test accuracy: 0.795
-----------------------
epoch 17 avg accuracy on training data: 0.9586667733674776
-----------------------
test accuracy: 0.79
-----------------------
-----------------------
test accuracy: 0.795
-----------------------
-----------------------
test accuracy: 0.79
-----------------------
-----------------------
test accuracy: 0.795
-----------------------
epoch 18 avg accuracy on training data: 0.9611675736235595
-----------------------
test accuracy: 0.78
-----------------------
-----------------------
test accuracy: 0.785
-----------------------
-----------------------
test accuracy: 0.78
-----------------------
-----------------------
test accuracy: 0.815
-----------------------
epoch 19 avg accuracy on training data: 0.9676296414852753
-----------------------
test accuracy: 0.795
-----------------------
-----------------------
test accuracy: 0.805
-----------------------
-----------------------
test accuracy: 0.805
-----------------------
-----------------------
test accuracy: 0.795
-----------------------
epoch 20 avg accuracy on training data: 0.9699503841229193
-----------------------
test accuracy: 0.76
-----------------------
-----------------------
test accuracy: 0.795
-----------------------
-----------------------
test accuracy: 0.795
-----------------------
-----------------------
test accuracy: 0.8
-----------------------
epoch 21 avg accuracy on training data: 0.9688900448143406
-----------------------
test accuracy: 0.79
-----------------------
-----------------------
test accuracy: 0.79
-----------------------
-----------------------
test accuracy: 0.81
-----------------------
-----------------------
test accuracy: 0.81
-----------------------
epoch 22 avg accuracy on training data: 0.9727912932138284
-----------------------
test accuracy: 0.805
-----------------------
-----------------------
test accuracy: 0.785
-----------------------
-----------------------
test accuracy: 0.785
-----------------------
-----------------------
test accuracy: 0.79
-----------------------
epoch 23 avg accuracy on training data: 0.9744718309859155
-----------------------
test accuracy: 0.785
-----------------------
-----------------------
test accuracy: 0.79
-----------------------
-----------------------
test accuracy: 0.765
-----------------------
-----------------------
test accuracy: 0.825
-----------------------
epoch 24 avg accuracy on training data: 0.9757922535211268
-----------------------
test accuracy: 0.815
-----------------------
-----------------------
test accuracy: 0.82
-----------------------
-----------------------
test accuracy: 0.8
-----------------------
-----------------------
test accuracy: 0.81
-----------------------
epoch 25 avg accuracy on training data: 0.9777928937259923
-----------------------
test accuracy: 0.795
-----------------------
-----------------------
test accuracy: 0.815
-----------------------
-----------------------
test accuracy: 0.795
-----------------------
-----------------------
test accuracy: 0.83
-----------------------
epoch 26 avg accuracy on training data: 0.9776728553137004
-----------------------
test accuracy: 0.81
-----------------------
-----------------------
test accuracy: 0.84
-----------------------
-----------------------
test accuracy: 0.785
-----------------------
-----------------------
test accuracy: 0.81
-----------------------
epoch 27 avg accuracy on training data: 0.9790332906530089
-----------------------
test accuracy: 0.81
-----------------------
-----------------------
test accuracy: 0.795
-----------------------
-----------------------
test accuracy: 0.82
-----------------------
-----------------------
test accuracy: 0.82
-----------------------
epoch 28 avg accuracy on training data: 0.9806538092189501
-----------------------
test accuracy: 0.825
-----------------------
-----------------------
test accuracy: 0.805
-----------------------
-----------------------
test accuracy: 0.81
-----------------------
-----------------------
test accuracy: 0.825
-----------------------
epoch 29 avg accuracy on training data: 0.9803937259923176
-----------------------
test accuracy: 0.835
-----------------------
-----------------------
test accuracy: 0.795
-----------------------
-----------------------
test accuracy: 0.84
-----------------------
-----------------------
test accuracy: 0.8
-----------------------
epoch 30 avg accuracy on training data: 0.9812540012804097
-----------------------
test accuracy: 0.805
-----------------------
-----------------------
test accuracy: 0.79
-----------------------
-----------------------
test accuracy: 0.825
-----------------------
-----------------------
test accuracy: 0.82
-----------------------
epoch 31 avg accuracy on training data: 0.982574423815621
-----------------------
test accuracy: 0.81
-----------------------
-----------------------
test accuracy: 0.83
-----------------------
-----------------------
test accuracy: 0.8
-----------------------
-----------------------
test accuracy: 0.81
-----------------------
epoch 32 avg accuracy on training data: 0.9828545134443022
-----------------------
test accuracy: 0.825
-----------------------
Traceback (most recent call last):
  File "train_convnet_pytorch.py", line 186, in <module>
    main()
  File "train_convnet_pytorch.py", line 169, in main
    train()
  File "train_convnet_pytorch.py", line 110, in train
    test_output = cnn(X_test)
  File "/home/lgpu0062/.conda/envs/dl/lib/python3.7/site-packages/torch/nn/modules/module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/lgpu0062/DeepLearningUvA/Assignment 1/code/convnet_pytorch.py", line 128, in forward
    out = layer(out)
  File "/home/lgpu0062/.conda/envs/dl/lib/python3.7/site-packages/torch/nn/modules/module.py", line 547, in __call__
    result = self.forward(*input, **kwargs)
  File "/home/lgpu0062/.conda/envs/dl/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 343, in forward
    return self.conv2d_forward(input, self.weight)
  File "/home/lgpu0062/.conda/envs/dl/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 340, in conv2d_forward
    self.padding, self.dilation, self.groups)
RuntimeError: CUDA out of memory. Tried to allocate 20.00 MiB (GPU 0; 10.92 GiB total capacity; 10.28 GiB already allocated; 15.50 MiB free; 83.86 MiB cached)
srun: error: r31n5: task 0: Exited with exit code 1
